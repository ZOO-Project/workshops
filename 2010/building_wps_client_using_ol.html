

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building a WPS client using OpenLayers &mdash; ZOO-Project 1.7 documentation</title>
  
  <link href="http://fonts.googleapis.com/css?family=Days+One" rel="stylesheet" type="text/css">
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within ZOO-Project 1.7 documentation" href="../_static/opensearch.xml"/>
    

  

  
  

  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="ZOO-Project 1.7 documentation" href="../index.html"/>
        <link rel="up" title="ZOO-Project Workshop 2010" href="index.html"/>
        <link rel="next" title="Exercise" href="exercise.html"/>
        <link rel="prev" title="Creating OGR based Web Services" href="ogr_base_vect_ops.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        

        
	  <a class="shrink" href="http://zoo-project.org"><img src="http://zoo-project.org/images/zoo-sun-logo.png" class="img-responsive sun" style="display: inline;"> ZOO</a>
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../2024/foss4g/index.html">ZOO-Project – Introduction to OGC API - Processes - Part 1: Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/using_zoo_from_docker.html">Installation, configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/first_service.html">Creating your first ZOO-Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/building_blocks_presentation.html">Building blocks presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/js_services_chaining.html">Playing with building blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g/solutions.html">Issue playing with building blocks?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2024/foss4g-europe/index.html">ZOO-Project – Introduction to OGC API - Processes - Part 1: Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/using_zoo_from_docker.html">Installation, configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/first_service.html">Creating your first ZOO-Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/building_blocks_presentation.html">Building blocks presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/js_services_chaining.html">Playing with building blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2024/foss4g-europe/solutions.html">Issue playing with building blocks?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2023/foss4g/index.html">ZOO-Project – Introduction to OGC API - Processes - Part 1: Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/using_zoo_from_docker.html">Installation, configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/building_blocks_presentation.html">Building blocks presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/js_services_chaining.html">Playing with building blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/foss4g/solutions.html">Issue playing with building blocks?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2023/ogc-member-meeting/index.html">ZOO-Project introduction to OGC API - Processes - Part 1: Core secutiy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023/ogc-member-meeting/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/ogc-member-meeting/using_zoo_from_docker.html">Installation, configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/ogc-member-meeting/setup_security_basicauth.html">Secure access to specific end-points using HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/ogc-member-meeting/setup_security_openid_connect.html">Using OpenID Connect 1.0 to authenticate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2022/index.html">ZOO-Project workshop 2022</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/using_zoo_from_docker.html">Installation, configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/building_blocks_presentation.html">Building blocks presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/js_services_chaining.html">Playing with building blocks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2017/index.html">ZOO-Project workshop 2017</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2017/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2017/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2017/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2017/building_blocks_presentation.html">Building blocks presentation - Using OGR and PgRouting based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2017/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2016/index.html">ZOO-Project workshop 2016</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2016/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2016/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2016/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2016/building_blocks_presentation.html">Building blocks presentation - Using OGR and PgRouting based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2016/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2015/index.html">ZOO-Project workshop 2015</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2015/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2015/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2015/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2015/building_blocks_presentation.html">Building blocks presentation - Using OGR and PgRouting based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2015/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2014/index.html">ZOO-Project workshop 2014</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2014/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2014/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2014/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2014/building_blocks_presentation.html">Building blocks presentation - Using OGR and PgRouting based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2014/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2013/index.html">ZOO-Project Workshop 2013</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2013/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2013/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2013/first_service.html">Create your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2013/building_blocks_presentation.html">Building blocks presentation - Using OGR and PgRouting based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2013/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2012/index.html">ZOO-Project Workshop 2012</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2012/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2012/using_zoo_from_osgeolivevm.html">Configuration and ZOO-Kernel use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2012/first_service.html">Creating your first ZOO Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2012/building_blocks_presentation.html">Presenting building blocks - Using OGR based Web Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2012/js_services_chaining.html">Playing with buildign blocks - Creating JavaScript Web Services</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ZOO-Project Workshop 2010</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_zoo_from_osgeolivevm.html">Using ZOO from an OSGeoLive virtual machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogr_base_vect_ops.html">Creating OGR based Web Services</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building a WPS client using OpenLayers</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercise.html">Exercise</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ZOO-Project</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">

    <li><a href="../index.html"> Workshops</a> &#8725; &#160;</li>
      
          <li><a href="index.html">ZOO-Project Workshop 2010</a> &#8725; &#160;</li>
      
    <li>Building a WPS client using OpenLayers</li>
      <li class="wy-breadcrumbs-aside">
        $Date$
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <section id="building-a-wps-client-using-openlayers">
<span id="building-wps-client-using-ol"></span><h1><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Building a WPS client using OpenLayers</a><a class="headerlink" href="#building-a-wps-client-using-openlayers" title="Link to this heading">¶</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#building-a-wps-client-using-openlayers" id="id1">Building a WPS client using OpenLayers</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-a-simple-map-showing-the-dataset-as-wms" id="id2">Creating a simple map showing the dataset as WMS</a></p></li>
<li><p><a class="reference internal" href="#fetching-the-data-layer-as-wfs-and-adding-selection-controls" id="id3">Fetching the data layer as WFS and adding selection controls</a></p></li>
<li><p><a class="reference internal" href="#calling-the-single-geometry-services-from-javascript" id="id4">Calling the single geometry services from JavaScript</a></p></li>
<li><p><a class="reference internal" href="#calling-the-multiples-geometries-processes-from-javascript" id="id5">Calling the multiples geometries processes from JavaScript</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>The next step of our workshop is to connect to the OGR Services we have created
from an OpenLayers map. This will allow to apply single or multiple geometries
processes on user-selected polygons and to display the new generated geometries.</p>
<section id="creating-a-simple-map-showing-the-dataset-as-wms">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Creating a simple map showing the dataset as WMS</a><a class="headerlink" href="#creating-a-simple-map-showing-the-dataset-as-wms" title="Link to this heading">¶</a></h2>
<p>OpenLayers is also included in OSGeoLive default distribution, so it is convenient
to use it for our needs. Please open <code class="docutils literal notranslate"><span class="pre">/var/www/zoo-ogr.html</span></code> using your favorite
text editor and paste the following HTML snippet:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span><span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="na">xml:lang</span><span class="o">=</span><span class="s">&quot;EN&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;EN&quot;</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;content-type&quot;</span><span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>ZOO WPS Client example<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">  </span><span class="p">#</span><span class="nn">map</span><span class="p">{</span><span class="k">width</span><span class="p">:</span><span class="mi">700</span><span class="kt">px</span><span class="p">;</span><span class="k">height</span><span class="p">:</span><span class="mi">600</span><span class="kt">px</span><span class="p">;}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/openlayers/theme/default/style.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/openlayers/lib/OpenLayers.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span> <span class="na">onload</span><span class="o">=</span><span class="s">&quot;init()&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The following JavaScript code must then be added in a <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;&lt;/script&gt;</span></code> section within the
<code class="docutils literal notranslate"><span class="pre">&lt;head&gt;</span></code> one. This will setup a map showing the japanese regions data as WMS.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nf">var</span><span class="w"> </span><span class="k">map</span><span class="p">,</span><span class="w"> </span><span class="n">layer</span><span class="p">,</span><span class="w"> </span><span class="k">select</span><span class="p">,</span><span class="w"> </span><span class="n">hover</span><span class="p">,</span><span class="w"> </span><span class="n">multi</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">;</span>
<span class="nf">var</span><span class="w"> </span><span class="n">typename</span><span class="o">=</span><span class="ss">&quot;regions&quot;</span><span class="p">;</span>
<span class="nf">var</span><span class="w"> </span><span class="n">main_url</span><span class="o">=</span><span class="ss">&quot;http://localhost/cgi-bin/mapserv?map=/var/www/wfs.map&quot;</span><span class="p">;</span>
<span class="k">function</span><span class="w"> </span><span class="n">init</span><span class="p">()</span><span class="err">{</span>
<span class="w">  </span><span class="k">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="p">.</span><span class="k">Map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">controls</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">      new OpenLayers.Control.PanZoom(),</span>
<span class="n">      new OpenLayers.Control.Permalink(),</span>
<span class="n">      new OpenLayers.Control.Navigation()</span>
<span class="n">    </span><span class="o">]</span>
<span class="w">  </span><span class="err">}</span><span class="p">);</span>
<span class="w">  </span><span class="n">layer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="p">.</span><span class="n">Layer</span><span class="p">.</span><span class="n">WMS</span><span class="p">(</span><span class="n">typename</span><span class="p">,</span><span class="n">main_url</span><span class="p">,</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nl">layers</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;regions&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">transparent</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nf">format</span><span class="err">:</span><span class="w"> </span><span class="s1">&#39;image/png&#39;</span>
<span class="w">      </span><span class="err">}</span><span class="p">,</span>
<span class="w">      </span><span class="err">{</span>
<span class="w">        </span><span class="nl">isBaseLayer</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">        </span><span class="nl">visibility</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">        </span><span class="nl">buffer</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nl">singleTile</span><span class="p">:</span><span class="w"> </span><span class="k">true</span>
<span class="w">      </span><span class="err">}</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="k">map</span><span class="p">.</span><span class="n">addLayers</span><span class="p">(</span><span class="o">[</span><span class="n">layer</span><span class="o">]</span><span class="p">);</span>
<span class="w">  </span><span class="k">map</span><span class="p">.</span><span class="n">setCenter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="p">.</span><span class="n">LonLat</span><span class="p">(</span><span class="mi">138</span><span class="p">,</span><span class="mf">33.5</span><span class="p">),</span><span class="mi">5</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>
</div>
<p>Once done, please save your HTML file as <code class="docutils literal notranslate"><span class="pre">zoo-ogr.html</span></code> in your workshop directory,
then copy it in <code class="docutils literal notranslate"><span class="pre">/var/www</span></code> and visualize it with your favorite Web browser using this link :
<code class="docutils literal notranslate"><span class="pre">http://localhost/zoo-ogr.html</span></code>. You should obtain a map centered on the Japan with the WMS layer activated.</p>
<a class="reference internal image-reference" href="../_images/OL-JP-1.png"><img alt="../_images/OL-JP-1.png" class="align-center" src="../_images/OL-JP-1.png" style="width: 356px; height: 280px;" />
</a>
</section>
<section id="fetching-the-data-layer-as-wfs-and-adding-selection-controls">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Fetching the data layer as WFS and adding selection controls</a><a class="headerlink" href="#fetching-the-data-layer-as-wfs-and-adding-selection-controls" title="Link to this heading">¶</a></h2>
<p>Before accessing the displayed data via WFS, you first have to create new vector layers
dedicated to host the several interactions we are going to create. Please add the following
lines within the <code class="docutils literal notranslate"><span class="pre">init()</span></code> function, and do not forget to add the newly created layer in
the map.addLayers method:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nt">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">OpenLayers</span><span class="p">.</span><span class="nc">Layer</span><span class="p">.</span><span class="nc">Vector</span><span class="o">(</span><span class="s2">&quot;Selection&quot;</span><span class="o">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">styleMap</span><span class="p">:</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="nf">Style</span><span class="p">(</span><span class="n">OpenLayers</span><span class="err">.</span><span class="n">Feature</span><span class="err">.</span><span class="n">Vector</span><span class="err">.</span><span class="kc">style</span><span class="cp">[</span><span class="s2">&quot;select&quot;</span><span class="cp">]</span><span class="p">)</span>
<span class="p">}</span><span class="o">);</span>

<span class="nt">hover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">OpenLayers</span><span class="p">.</span><span class="nc">Layer</span><span class="p">.</span><span class="nc">Vector</span><span class="o">(</span><span class="s2">&quot;Hover&quot;</span><span class="o">);</span>
<span class="nt">multi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">OpenLayers</span><span class="p">.</span><span class="nc">Layer</span><span class="p">.</span><span class="nc">Vector</span><span class="o">(</span><span class="s2">&quot;Multi&quot;</span><span class="o">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">styleMap</span><span class="p">:</span>
<span class="w">  </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="nf">Style</span><span class="p">(</span><span class="err">{</span>
<span class="w">    </span><span class="n">fillColor</span><span class="err">:</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">fillOpacity</span><span class="err">:</span><span class="mf">0.4</span><span class="p">,</span>
<span class="w">    </span><span class="n">strokeColor</span><span class="err">:</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">strokeOpacity</span><span class="err">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="n">strokeWidth</span><span class="err">:</span><span class="mi">2</span>
<span class="w">  </span><span class="err">}</span><span class="p">)</span>
<span class="p">}</span><span class="o">);</span>

<span class="nt">map</span><span class="p">.</span><span class="nc">addLayers</span><span class="o">(</span><span class="cp">[</span><span class="nx">layer</span><span class="p">,</span><span class="w"> </span><span class="k">select</span><span class="p">,</span><span class="w"> </span><span class="nx">hover</span><span class="p">,</span><span class="w"> </span><span class="nx">multi</span><span class="cp">]</span><span class="o">);</span>
</pre></div>
</div>
<p>Then, you can now access the data by creating new controls to select polygons, as the
following. Please note that <code class="docutils literal notranslate"><span class="pre">OpenLayers.Protocol.WFS.fromWMSLayer</span></code> is used to access
geometries and that several state of selection are declared and append to the control variable.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="k">var</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Protocol</span><span class="o">.</span><span class="n">WFS</span><span class="o">.</span><span class="n">fromWMSLayer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">featurePrefix</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;ms&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">geometryName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;msGeometry&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">featureType</span><span class="p">:</span><span class="w"> </span><span class="n">typename</span>
<span class="p">});</span>

<span class="n">control</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Control</span><span class="o">.</span><span class="n">GetFeature</span><span class="p">({</span>
<span class="w">        </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">protocol</span><span class="p">,</span>
<span class="w">        </span><span class="n">box</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="p">,</span>
<span class="w">        </span><span class="n">hover</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="p">,</span>
<span class="w">        </span><span class="n">multipleKey</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;shiftKey&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">toggleKey</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ctrlKey&quot;</span>
<span class="p">});</span>
<span class="n">control</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;featureselected&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">select</span><span class="o">.</span><span class="n">addFeatures</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">feature</span><span class="p">]);</span>
<span class="p">});</span>
<span class="n">control</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;featureunselected&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">select</span><span class="o">.</span><span class="n">removeFeatures</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">feature</span><span class="p">]);</span>
<span class="p">});</span>
<span class="n">map</span><span class="o">.</span><span class="n">addControl</span><span class="p">(</span><span class="n">control</span><span class="p">);</span>
<span class="n">control</span><span class="o">.</span><span class="n">activate</span><span class="p">();</span>
</pre></div>
</div>
<p>Please save your HTML file again. You should now be able to select a polygon only by
clicking on it. The selected polygon should appear in blue color.</p>
<a class="reference internal image-reference" href="../_images/OL-JP-2.png"><img alt="../_images/OL-JP-2.png" class="align-center" src="../_images/OL-JP-2.png" style="width: 356px; height: 280px;" />
</a>
</section>
<section id="calling-the-single-geometry-services-from-javascript">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Calling the single geometry services from JavaScript</a><a class="headerlink" href="#calling-the-single-geometry-services-from-javascript" title="Link to this heading">¶</a></h2>
<p>Now that everything is setup, we can go on and call our OGR ZOO services with JavaScript.
Please add the following lines after the <code class="docutils literal notranslate"><span class="pre">init()</span></code> function, which will call the single
geometry processes. You can notice that we use a specific <code class="docutils literal notranslate"><span class="pre">parseMapServerId</span></code> function
which let us remove the unecessary white space returned as fid value.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">function</span><span class="w"> </span><span class="n">parseMapServerId</span><span class="p">(){</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">sf</span><span class="o">=</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">sf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">sf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">g</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span><span class="w"> </span><span class="n">simpleProcessing</span><span class="p">(</span><span class="n">aProcess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="s2">&quot;No feature selected!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">multi</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">length</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">multi</span><span class="o">.</span><span class="n">removeFeatures</span><span class="p">(</span><span class="n">multi</span><span class="o">.</span><span class="n">features</span><span class="p">);</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">aProcess</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;Buffer&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s1">&#39;bufferDist&#39;</span><span class="p">)</span><span class="err">?</span><span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s1">&#39;bufferDist&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isNaN</span><span class="p">(</span><span class="n">dist</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="s2">&quot;Distance is not a Number!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">url</span><span class="o">+=</span><span class="s1">&#39;Identifier=Buffer&amp;DataInputs=BufferDistance=&#39;</span><span class="o">+</span><span class="n">dist</span><span class="o">+</span><span class="s1">&#39;@datatype=interger;InputPolygon=Reference@xlink:href=&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;Identifier=&#39;</span><span class="o">+</span><span class="n">aProcess</span><span class="o">+</span><span class="s1">&#39;&amp;DataInputs=InputPolygon=Reference@xlink:href=&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">xlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">url</span><span class="w"> </span><span class="o">+</span><span class="s2">&quot;&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;VERSION=1.0.0&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;typename=&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">featurePrefix</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">featureType</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;SRS=&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">srsName</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;FeatureID=&#39;</span><span class="o">+</span><span class="n">parseMapServerId</span><span class="p">(</span><span class="n">select</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fid</span><span class="p">);</span>
<span class="w">  </span><span class="n">url</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">encodeURIComponent</span><span class="p">(</span><span class="n">xlink</span><span class="p">);</span>
<span class="w">  </span><span class="n">url</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;RawDataOutput=Result@mimeType=application/json&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">XMLHttpRequest</span><span class="p">();</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="bp">true</span><span class="p">);</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">readyState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">XMLHttpRequest</span><span class="o">.</span><span class="n">DONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">var</span><span class="w"> </span><span class="n">GeoJSON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Format</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">();</span>
<span class="w">      </span><span class="k">var</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoJSON</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">responseText</span><span class="p">);</span>
<span class="w">      </span><span class="n">hover</span><span class="o">.</span><span class="n">removeFeatures</span><span class="p">(</span><span class="n">hover</span><span class="o">.</span><span class="n">features</span><span class="p">);</span>
<span class="w">      </span><span class="n">hover</span><span class="o">.</span><span class="n">addFeatures</span><span class="p">(</span><span class="n">features</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">send</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, some specific buttons must be added in the HTML, in order to be able to call
the different processes we just declared. You can add them on top of the map by writing
the following lines before the <code class="docutils literal notranslate"><span class="pre">&lt;div</span> <span class="pre">id=&quot;map&quot;&gt;&lt;/div&gt;</span></code>.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">style=</span><span class="s">&quot;float: right;padding-left: 5px;&quot;</span><span class="nt">&gt;</span>
<span class="w"> </span><span class="nt">&lt;h3&gt;</span>Single<span class="w"> </span>geometry<span class="w"> </span>processing<span class="nt">&lt;/h3&gt;</span>
<span class="w"> </span><span class="nt">&lt;ul&gt;</span>
<span class="w">   </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;simpleProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Buffer&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;bufferDist&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;simpleProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;ConvexHull&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;simpleProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Boundary&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;simpleProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Centroid&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/li&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Save your HTML file again. You should now be able to select a polygon and to launch a Buffer,
ConvexHull, Boundary or Centroid on it by clicking one of the button. The result of the
process should appear as GeoJSON layer on the map, in orange color.</p>
<a class="reference internal image-reference" href="../_images/OL-JP-3.png"><img alt="../_images/OL-JP-3.png" class="align-center" src="../_images/OL-JP-3.png" style="width: 536px; height: 270px;" />
</a>
</section>
<section id="calling-the-multiples-geometries-processes-from-javascript">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Calling the multiples geometries processes from JavaScript</a><a class="headerlink" href="#calling-the-multiples-geometries-processes-from-javascript" title="Link to this heading">¶</a></h2>
<p>Using the same technique, you can now write a function dedicated to the multiple geometries
processes. Please add the following lines after the <code class="docutils literal notranslate"><span class="pre">simpleProcessing()</span></code> function, we will
guide you during the exercise in section 5 on how to create such a function.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">function</span><span class="w"> </span><span class="n">multiProcessing</span><span class="p">(</span><span class="n">aProcess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">hover</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="s2">&quot;No feature created!&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/cgi-bin/zoo_loader.cgi&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">xlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">url</span><span class="w"> </span><span class="o">+</span><span class="s2">&quot;&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;VERSION=1.0.0&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;typename=&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">featurePrefix</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">featureType</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;SRS=&#39;</span><span class="o">+</span><span class="n">control</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">srsName</span><span class="p">;</span>
<span class="w">  </span><span class="n">xlink</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&amp;FeatureID=&#39;</span><span class="o">+</span><span class="n">parseMapServerId</span><span class="p">(</span><span class="n">select</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fid</span><span class="p">);</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">GeoJSON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Format</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">();</span>
<span class="w">  </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:Execute service=&quot;WPS&quot; version=&quot;1.0.0&quot; xmlns:wps=&quot;http://www.opengis.net/wps/1.0.0&quot; xmlns:ows=&quot;http://www.opengis.net/ows/1.1&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.opengis.net/wps/1.0.0/../wpsExecute_request.xsd&quot;&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;ows:Identifier&gt;&#39;</span><span class="o">+</span><span class="n">aProcess</span><span class="o">+</span><span class="s1">&#39;&lt;/ows:Identifier&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:DataInputs&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:Input&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;ows:Identifier&gt;InputEntity1&lt;/ows:Identifier&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:Reference xlink:href=&quot;&#39;</span><span class="o">+</span><span class="n">xlink</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/&amp;/</span><span class="n">gi</span><span class="p">,</span><span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;/&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:Input&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:Input&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;ows:Identifier&gt;InputEntity2&lt;/ows:Identifier&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:Data&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:ComplexData mimeType=&quot;application/json&quot;&gt; &#39;</span><span class="o">+</span><span class="n">GeoJSON</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hover</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &lt;/wps:ComplexData&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:Data&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:Input&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:DataInputs&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:ResponseForm&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;wps:RawDataOutput&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;ows:Identifier&gt;Result&lt;/ows:Identifier&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:RawDataOutput&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:ResponseForm&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/wps:Execute&gt;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">XMLHttpRequest</span><span class="p">();</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="bp">true</span><span class="p">);</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span><span class="s1">&#39;text/xml&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">readyState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">XMLHttpRequest</span><span class="o">.</span><span class="n">DONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">var</span><span class="w"> </span><span class="n">GeoJSON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">OpenLayers</span><span class="o">.</span><span class="n">Format</span><span class="o">.</span><span class="n">GeoJSON</span><span class="p">();</span>
<span class="w">      </span><span class="k">var</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoJSON</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">responseText</span><span class="p">);</span>
<span class="w">      </span><span class="n">multi</span><span class="o">.</span><span class="n">removeFeatures</span><span class="p">(</span><span class="n">multi</span><span class="o">.</span><span class="n">features</span><span class="p">);</span>
<span class="w">      </span><span class="n">multi</span><span class="o">.</span><span class="n">addFeatures</span><span class="p">(</span><span class="n">features</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">request</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that this time we didn’t use the GET method to request the ZOO Kernel but a XML POST.
We did that because if you use the GET method you will get error due to the HTTP GET method
limitation based on the length of your request. Using JSON string representing the geometry
will make your request longer.</p>
<p>Once you get the functions to call your multiple geometries processes, you’ must add some
buttons to fire the request call. Here is the HTML code to add to your current <code class="docutils literal notranslate"><span class="pre">zoo-ogr.html</span></code> file :</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;h3&gt;</span>Multiple<span class="w"> </span>geometries<span class="w"> </span>processing<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;ul&gt;</span>
<span class="w">  </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;multiProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Union&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/li&gt;</span>
<span class="w">  </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;multiProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Difference&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/li&gt;</span>
<span class="w">  </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;multiProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;SymDifference&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/li&gt;</span>
<span class="w">  </span><span class="nt">&lt;li&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="w"> </span><span class="na">onclick=</span><span class="s">&quot;multiProcessing(this.value);&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Intersection&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
<p>Please reload the page. You should then be able to run your multiple geometries services and
you should get results displayed in red as shown by the following screenshots :</p>
<a class="reference internal image-reference" href="../_images/OL-JP-4.png"><img alt="../_images/OL-JP-4.png" src="../_images/OL-JP-4.png" style="width: 406px; height: 140px;" />
</a>
<a class="reference internal image-reference" href="../_images/OL-JP-5.png"><img alt="../_images/OL-JP-5.png" src="../_images/OL-JP-5.png" style="width: 406px; height: 140px;" />
</a>
<a class="reference internal image-reference" href="../_images/OL-JP-6.png"><img alt="../_images/OL-JP-6.png" src="../_images/OL-JP-6.png" style="width: 406px; height: 140px;" />
</a>
<a class="reference internal image-reference" href="../_images/OL-JP-7.png"><img alt="../_images/OL-JP-7.png" src="../_images/OL-JP-7.png" style="width: 406px; height: 140px;" />
</a>
<p>It seems that something is missing in your Services Provider to get the same results …
The multiple geometries Services ! This is what we are going to do together in the next section.</p>
</section>
</section>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="exercise.html" class="btn btn-neutral float-right" title="Exercise">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ogr_base_vect_ops.html" class="btn btn-neutral" title="Creating OGR based Web Services"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  <div class="pfoot">
  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2023, ZOO-Project team. This work is released under a Creative Commons Attribution-ShareAlike 4.0 International Public License.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> inspired by <a href="https://readthedocs.org">Read the Docs</a>.
</div>
</footer>

        </div>
      </div>

    </section>

  </div>
  


  
    <div id="documentation_options" data-version="1.7" data-url_root="../"></div>
    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>